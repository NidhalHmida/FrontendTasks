<h1>Gestion des utilisateurs </h1>
<p-toast ></p-toast>
<nb-card *ngIf="operation==='view'">
    <nb-card-header>Détails d'un utilisateur</nb-card-header>
    <nb-card-body class="example-items-col">
        </nb-card-body>
       <img src="{{selectedUser.image}}">
       <p> Nom Complet :{{selectedUser.fullname}}</p>
       <p>Email : {{selectedUser.email}}</p>
       <p> Date de naissnance:{{selectedUser.birthday}}</p>
       <p> Préférences: {{selectedUser.preference}}</p>
       <p *ngIf="selectedUser.stateCompte=='1'"> Etat de compte : Activée</p>
       <p *ngIf="selectedUser.stateCompte=='0'"> Etat de compte : Non activée</p>
       <p *ngIf="selectedUser.statePayment=='1'"> Etat de paiement : Payé</p>
       <p *ngIf="selectedUser.statePayment=='0'"> Etat de paiement :Non payé</p>
</nb-card>
<nb-card>
    <nb-card-body class="example-items-col">
      <p-table #dt [value]="users"  dataKey="id" styleClass="p-datatable-customers" [rowHover]="true"
      [rows]="10" [showCurrentPageReport]="true" [rowsPerPageOptions]="[10,25,50]" 
      [paginator]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      [filterDelay]="0" [globalFilterFields]="['title']">
      <ng-template pTemplate="caption">
          <div class="table-header">
              Liste des utilisateurs<br>
              <span class="p-input-icon-left">
                  <i class="pi pi-search"></i>
                  <input pInputText type="text" (input)="dt.filterGlobal($event.target.value, 'contains')" placeholder="Recherche globale" />
              </span>
          </div>
      </ng-template>
      <ng-template pTemplate="header">
          <tr>
              <th>Photo de profil</th>
              <th pSortableColumn="fullname">Nom Complet<p-sortIcon field="fullname"></p-sortIcon></th>
              <th>Email</th>
              <th style="width: 8rem">Actions</th>
          </tr>
          <tr> 
            <th></th>
              <th>
                  <input pInputText type="text" (input)="dt.filter($event.target.value, 'fullname', 'contains')" placeholder="Recherche par nom" class="p-column-filter">
              </th>
              <th>
                <input pInputText type="text" (input)="dt.filter($event.target.value, 'email', 'contains')" placeholder="Recherche par email" class="p-column-filter">
            </th>
            <th></th>
          </tr>
      </ng-template>
      <ng-template pTemplate="body" let-data>
        <tr class="p-selectable-row" >
            <td > <img [alt]="data.fullname" src="{{data.image}}" style="vertical-align: middle" /></td>
            <td (click)="selectedUserOperation(data,'view')" > 
                {{data.fullname}}
            </td>
            <td (click)="selectedUserOperation(data,'view')" >  
                {{data.email}}
            </td>
              <td style="text-align: center">
                <button type="button" pButton icon="pi pi-bars" label="Actions" (click)="menu.toggle($event,data);onClickMenu(data);" ></button>
                <p-menu #menu [popup]="true" [model]="items"></p-menu>
            </td>
          </tr>
      </ng-template>
  </p-table>
    </nb-card-body>
    </nb-card>
    <p-dialog [(visible)]="dataDialog" [style]="{width: '500px'}" header="Affectation suite de programmes" [modal]="true" styleClass="p-fluid">
        <ng-template pTemplate="content">
            <div class="p-field">
                <p-multiSelect [options]="suiteprogrammes" [(ngModel)]="selectedUser.programGroup" optionLabel="title" placeholder="Choisissez une suite de programmes"></p-multiSelect>
                <input  type="text" disabled nbInput [(ngModel)]="selectedUser.fullname" fullWidth status="primary" fieldSize="small" placeholder="Utilisateur">
            </div>
        </ng-template>
        
        <ng-template pTemplate="footer">
            <button pButton pRipple label="Valider" icon="pi pi-check" class="p-button-text" (click)="onSubmit()"></button>
            <button pButton pRipple label="Annuler" icon="pi pi-times" class="p-button-text" (click)="hideDialog()"></button>
        </ng-template>
        </p-dialog>
    <p-confirmDialog [style]="{width: '450px'}"></p-confirmDialog>
